
<head>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://unpkg.com/sunburst-chart"></script>

  <style>body { margin: 0 }</style>

</head>
<body>
  <div id="chart"></div>

  <script>
    const data = 
{ name: "all", calls: 1, size: 0, value: 3.719, min: 3.719, max: 3.719, avg: 3.719, children: [{ name: "ngcore::ParallelFor<int,ngcore::EnterTaskManager()::{lambda(int)#1}>(ngcore::T_Range<int>,ngcore::EnterTaskManager()::{lambda(int)#1},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 1, size: 0.01444, value: 0.01444, min: 0.01444, max: 0.01444, avg: 0.01444} , { name: "MeshOptimize3d::SwapImprove", calls: 10, size: 0.03086, value: 3.152, min: 0.2762, max: 0.3834, avg: 0.3152, children: [{ name: "ngcore::ParallelForRange<netgen::ElementIndex,netgen::MeshOptimize3d::SwapImprove(netgen::Mesh&,netgen::OPTIMIZEGOAL,netgen::NgBitArray const*)::{lambda(auto:1)#1}>(ngcore::T_Range<netgen::ElementIndex>,netgen::MeshOptimize3d::SwapImprove(netgen::Mesh&,netgen::OPTIMIZEGOAL,netgen::NgBitArray const*)::{lambda(auto:1)#1},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.04435, value: 0.04435, min: 0.003526, max: 0.00663, avg: 0.004435} , { name: "Build edges", calls: 10, size: 0.004876, value: 0.02281, min: 0.001852, max: 0.003594, avg: 0.002281, children: [{ name: "ngcore::ParallelFor<unsigned long,netgen::BuildEdgeList<netgen::ElementIndex>(netgen::Mesh const&,ngcore::Table<netgen::ElementIndex,netgen::PointIndex>const&,ngcore::Array<std::tuple<netgen::PointIndex,netgen::PointIndex>,unsigned long>&)::{lambda(int)#1}>(ngcore::T_Range<unsigned long>,netgen::BuildEdgeList<netgen::ElementIndex>(netgen::Mesh const&,ngcore::Table<netgen::ElementIndex,netgen::PointIndex>const&,ngcore::Array<std::tuple<netgen::PointIndex,netgen::PointIndex>,unsigned long>&)::{lambda(int)#1},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.01794, value: 0.01794, min: 0.001534, max: 0.002125, avg: 0.001794}]} , { name: "CreateSortedTable", calls: 10, size: 0.001117, value: 0.2688, min: 0.01914, max: 0.04548, avg: 0.02688, children: [{ name: "ngcore::ParallelForRange<netgen::PointIndex,ngcore::CreateSortedTable<netgen::ElementIndex,netgen::PointIndex,ngcore::T_Range<netgen::ElementIndex>,netgen::Mesh::CreatePoint2ElementTable(std::optional<ngcore::BitArray>)const::{lambda(auto:1&,netgen::ElementIndex)#1}>(ngcore::T_Range<netgen::ElementIndex>const&,netgen::Mesh::CreatePoint2ElementTable(std::optional<ngcore::BitArray>)const::{lambda(auto:1&,netgen::ElementIndex)#1}const&,std::optional<unsigned long>)::{lambda(auto:1)#1}>(ngcore::T_Range<netgen::PointIndex>,ngcore::Table,int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.04987, value: 0.04987, min: 0.001313, max: 0.02585, avg: 0.004987} , { name: "CreateTable", calls: 10, size: 0.01414, value: 0.2178, min: 0.01775, max: 0.03632, avg: 0.02178, children: [{ name: "ngcore::ParallelForRange<netgen::ElementIndex,ngcore::CreateTable<netgen::ElementIndex,netgen::PointIndex,ngcore::T_Range<netgen::ElementIndex>,netgen::Mesh::CreatePoint2ElementTable(std::optional<ngcore::BitArray>)const::{lambda(auto:1&,netgen::ElementIndex)#1}>(ngcore::T_Range<netgen::ElementIndex>const&,netgen::Mesh::CreatePoint2ElementTable(std::optional<ngcore::BitArray>)const::{lambda(auto:1&,netgen::ElementIndex)#1}const&,std::optional<unsigned long>)::{lambda(auto:1)#1}>(ngcore::T_Range<netgen::ElementIndex>,ngcore::Table,int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 20, size: 0.1885, value: 0.1885, min: 0.007202, max: 0.02399, avg: 0.009424} , { name: "ngcore::TablePrefixSum2<unsigned int>(ngcore::FlatArray<unsigned int,unsigned long>)::{lambda(ngcore::TaskInfo)#1}", calls: 10, size: 0.007035, value: 0.007035, min: 0.0005567, max: 0.0008726, avg: 0.0007035} , { name: "ngcore::TablePrefixSum2<unsigned int>(ngcore::FlatArray<unsigned int,unsigned long>)::{lambda(ngcore::TaskInfo)#2}", calls: 10, size: 0.008179, value: 0.008179, min: 0.0006346, max: 0.001139, avg: 0.0008179}]}]} , { name: "MeshOptimize3d::SwapImprove loop", calls: 10, size: 0.001403, value: 0.01239, min: 0.00107, max: 0.001758, avg: 0.001239, children: [{ name: "ngcore::ParallelForRange<unsigned long,netgen::MeshOptimize3d::SwapImprove(netgen::Mesh&,netgen::OPTIMIZEGOAL,netgen::NgBitArray const*)::{lambda(auto:1)#2}>(ngcore::T_Range<unsigned long>,netgen::MeshOptimize3d::SwapImprove(netgen::Mesh&,netgen::OPTIMIZEGOAL,netgen::NgBitArray const*)::{lambda(auto:1)#2},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.01099, value: 0.01099, min: 0.0009419, max: 0.001509, avg: 0.001099}]} , { name: "Mesh::BuildBoundaryEdges", calls: 10, size: 0.68, value: 0.68, min: 6.113e-05, max: 0.09246, avg: 0.068} , { name: "Mesh::Compress", calls: 10, size: 0.2272, value: 2.093, min: 0.1786, max: 0.3127, avg: 0.2093, children: [{ name: "ngcore::ParallelForRange<netgen::ElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#1}>(ngcore::T_Range<netgen::ElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#1},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.6381, value: 0.6381, min: 0.05521, max: 0.08061, avg: 0.06381} , { name: "ngcore::ParallelForRange<netgen::SurfaceElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#2}>(ngcore::T_Range<netgen::SurfaceElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#2},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.1279, value: 0.1279, min: 0.008034, max: 0.02394, avg: 0.01279} , { name: "ngcore::ParallelForRange<netgen::ElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#3}>(ngcore::T_Range<netgen::ElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#3},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.1017, value: 0.1017, min: 0.006886, max: 0.02418, avg: 0.01017} , { name: "ngcore::ParallelForRange<netgen::SurfaceElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#4}>(ngcore::T_Range<netgen::SurfaceElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#4},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.05224, value: 0.05224, min: 0.004519, max: 0.00596, avg: 0.005224} , { name: "Mesh::LinkSurfaceElements", calls: 10, size: 0.2222, value: 0.2222, min: 0.01934, max: 0.0339, avg: 0.02222} , { name: "Mesh::CalcSurfacesOfNode", calls: 10, size: 0.1401, value: 0.7237, min: 0.05987, max: 0.1203, avg: 0.07237, children: [{ name: "Mesh::CalcSurfacesOfNode, pointloop", calls: 10, size: 0.1098, value: 0.1098, min: 0.008663, max: 0.0297, avg: 0.01098} , { name: "Mesh::CalcSurfacesOfNode - surfelementht", calls: 10, size: 0.1615, value: 0.1615, min: 0.01412, max: 0.02317, avg: 0.01615} , { name: "Mesh::CalcSurfacesOfNode - surf on node", calls: 10, size: 0.3122, value: 0.3122, min: 0.02673, max: 0.05602, avg: 0.03122}]}]}]} , { name: "FreeOpenElementsEnvironment", calls: 2, size: 0.1668, value: 0.1668, min: 0.03867, max: 0.1281, avg: 0.08339} , { name: "Mesh::Compress", calls: 1, size: 0.02555, value: 0.2416, min: 0.2416, max: 0.2416, avg: 0.2416, children: [{ name: "ngcore::ParallelForRange<netgen::ElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#1}>(ngcore::T_Range<netgen::ElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#1},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 1, size: 0.06207, value: 0.06207, min: 0.06207, max: 0.06207, avg: 0.06207} , { name: "ngcore::ParallelForRange<netgen::SurfaceElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#2}>(ngcore::T_Range<netgen::SurfaceElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#2},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 1, size: 0.007869, value: 0.007869, min: 0.007869, max: 0.007869, avg: 0.007869} , { name: "ngcore::ParallelForRange<netgen::ElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#3}>(ngcore::T_Range<netgen::ElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#3},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 1, size: 0.008034, value: 0.008034, min: 0.008034, max: 0.008034, avg: 0.008034} , { name: "ngcore::ParallelForRange<netgen::SurfaceElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#4}>(ngcore::T_Range<netgen::SurfaceElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#4},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 1, size: 0.01872, value: 0.01872, min: 0.01872, max: 0.01872, avg: 0.01872} , { name: "Mesh::LinkSurfaceElements", calls: 1, size: 0.01981, value: 0.01981, min: 0.01981, max: 0.01981, avg: 0.01981} , { name: "Mesh::CalcSurfacesOfNode", calls: 1, size: 0.01059, value: 0.09957, min: 0.09957, max: 0.09957, avg: 0.09957, children: [{ name: "Mesh::CalcSurfacesOfNode, pointloop", calls: 1, size: 0.009045, value: 0.009045, min: 0.009045, max: 0.009045, avg: 0.009045} , { name: "Mesh::CalcSurfacesOfNode - surfelementht", calls: 1, size: 0.01447, value: 0.01447, min: 0.01447, max: 0.01447, avg: 0.01447} , { name: "Mesh::CalcSurfacesOfNode - surf on node", calls: 1, size: 0.06547, value: 0.06547, min: 0.06547, max: 0.06547, avg: 0.06547}]}]}]};

const chart_type = 'time';

    const color = d3.scaleOrdinal(d3.schemePaired);

    let getTime = (t) =>
    {
       if(t>=1000)  return (t/1000).toPrecision(4) + '  s';
       if(t>=0.1)   return t.toPrecision(4) + ' ms';
       if(t>=1e-4)  return (t*1e3).toPrecision(4) + ' us';

       return (t/1e6).toPrecision(4) + ' ns';
    };

    const KB_ = 1024;
    const MB_ = KB_*1024;
    const GB_ = MB_*1024;
    let getMemory = (m) =>
    {
       if(m>=GB_)  return (m/GB_).toPrecision(4) + ' GB';
       if(m>=MB_)  return (m/MB_).toPrecision(4) + ' MB';
       if(m>=KB_)  return (m/KB_).toPrecision(4) + ' KB';
       return m.toPrecision(4) + ' B';
    };

    Sunburst()
      .data(data)
      .size('size')
      .color(d => color(d.name))
      .tooltipTitle((d, node) => { return node.parent ? node.parent.data.name + " &rarr; " + d.name : d.name; })
      .tooltipContent((d, node) => {
        if(chart_type=="memory")
        {
          return `Total Memory: <i>${getMemory(d.value)}</i> <br>`
               + `Memory: <i>${getMemory(d.size)}</i>`
        }
        else
        {
          return `Time: <i>${getTime(d.value)}</i> <br>`
               + `calls: <i>${d.calls}</i> <br>`
               + `min: <i>${getTime(d.min)}</i> <br>`
               + `max: <i>${getTime(d.max)}</i> <br>`
               + `avg: <i>${getTime(d.avg)}</i>`
        }
      })
      (document.getElementById('chart'));

      // Line breaks in tooltip
      var all = document.getElementsByClassName('sunbirst-tooltip');
      for (var i = 0; i < all.length; i++) {
          all[i].white_space = "";
      }
  </script>
</body>


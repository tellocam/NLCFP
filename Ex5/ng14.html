
<head>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://unpkg.com/sunburst-chart"></script>

  <style>body { margin: 0 }</style>

</head>
<body>
  <div id="chart"></div>

  <script>
    const data = 
{ name: "all", calls: 1, size: 0, value: 1.573, min: 1.573, max: 1.573, avg: 1.573, children: [{ name: "ngcore::ParallelFor<int,ngcore::EnterTaskManager()::{lambda(int)#1}>(ngcore::T_Range<int>,ngcore::EnterTaskManager()::{lambda(int)#1},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 1, size: 0.000774, value: 0.000774, min: 0.000774, max: 0.000774, avg: 0.000774} , { name: "MeshOptimize3d::SwapImprove", calls: 10, size: 0.04607, value: 1.348, min: 0.07526, max: 0.2751, avg: 0.1348, children: [{ name: "ngcore::ParallelForRange<netgen::ElementIndex,netgen::MeshOptimize3d::SwapImprove(netgen::Mesh&,netgen::OPTIMIZEGOAL,netgen::NgBitArray const*)::{lambda(auto:1)#1}>(ngcore::T_Range<netgen::ElementIndex>,netgen::MeshOptimize3d::SwapImprove(netgen::Mesh&,netgen::OPTIMIZEGOAL,netgen::NgBitArray const*)::{lambda(auto:1)#1},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.01607, value: 0.01607, min: 0.001213, max: 0.002157, avg: 0.001607} , { name: "Build edges", calls: 10, size: 0.004306, value: 0.02097, min: 0.001563, max: 0.003331, avg: 0.002097, children: [{ name: "ngcore::ParallelFor<unsigned long,netgen::BuildEdgeList<netgen::ElementIndex>(netgen::Mesh const&,ngcore::Table<netgen::ElementIndex,netgen::PointIndex>const&,ngcore::Array<std::tuple<netgen::PointIndex,netgen::PointIndex>,unsigned long>&)::{lambda(int)#1}>(ngcore::T_Range<unsigned long>,netgen::BuildEdgeList<netgen::ElementIndex>(netgen::Mesh const&,ngcore::Table<netgen::ElementIndex,netgen::PointIndex>const&,ngcore::Array<std::tuple<netgen::PointIndex,netgen::PointIndex>,unsigned long>&)::{lambda(int)#1},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.01666, value: 0.01666, min: 0.001284, max: 0.002835, avg: 0.001666}]} , { name: "CreateSortedTable", calls: 10, size: 0.001178, value: 0.3163, min: 0.007557, max: 0.1852, avg: 0.03163, children: [{ name: "ngcore::ParallelForRange<netgen::PointIndex,ngcore::CreateSortedTable<netgen::ElementIndex,netgen::PointIndex,ngcore::T_Range<netgen::ElementIndex>,netgen::Mesh::CreatePoint2ElementTable(std::optional<ngcore::BitArray>)const::{lambda(auto:1&,netgen::ElementIndex)#1}>(ngcore::T_Range<netgen::ElementIndex>const&,netgen::Mesh::CreatePoint2ElementTable(std::optional<ngcore::BitArray>)const::{lambda(auto:1&,netgen::ElementIndex)#1}const&,std::optional<unsigned long>)::{lambda(auto:1)#1}>(ngcore::T_Range<netgen::PointIndex>,ngcore::Table,int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.1899, value: 0.1899, min: 0.001107, max: 0.1785, avg: 0.01899} , { name: "CreateTable", calls: 10, size: 0.009627, value: 0.1252, min: 0.006368, max: 0.05485, avg: 0.01252, children: [{ name: "ngcore::ParallelForRange<netgen::ElementIndex,ngcore::CreateTable<netgen::ElementIndex,netgen::PointIndex,ngcore::T_Range<netgen::ElementIndex>,netgen::Mesh::CreatePoint2ElementTable(std::optional<ngcore::BitArray>)const::{lambda(auto:1&,netgen::ElementIndex)#1}>(ngcore::T_Range<netgen::ElementIndex>const&,netgen::Mesh::CreatePoint2ElementTable(std::optional<ngcore::BitArray>)const::{lambda(auto:1&,netgen::ElementIndex)#1}const&,std::optional<unsigned long>)::{lambda(auto:1)#1}>(ngcore::T_Range<netgen::ElementIndex>,ngcore::Table,int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 20, size: 0.1028, value: 0.1028, min: 0.002039, max: 0.04967, avg: 0.00514} , { name: "ngcore::TablePrefixSum2<unsigned int>(ngcore::FlatArray<unsigned int,unsigned long>)::{lambda(ngcore::TaskInfo)#1}", calls: 10, size: 0.006105, value: 0.006105, min: 0.000417, max: 0.0007902, avg: 0.0006105} , { name: "ngcore::TablePrefixSum2<unsigned int>(ngcore::FlatArray<unsigned int,unsigned long>)::{lambda(ngcore::TaskInfo)#2}", calls: 10, size: 0.006695, value: 0.006695, min: 0.0004792, max: 0.000794, avg: 0.0006695}]}]} , { name: "MeshOptimize3d::SwapImprove loop", calls: 10, size: 0.001491, value: 0.0131, min: 0.001116, max: 0.001472, avg: 0.00131, children: [{ name: "ngcore::ParallelForRange<unsigned long,netgen::MeshOptimize3d::SwapImprove(netgen::Mesh&,netgen::OPTIMIZEGOAL,netgen::NgBitArray const*)::{lambda(auto:1)#2}>(ngcore::T_Range<unsigned long>,netgen::MeshOptimize3d::SwapImprove(netgen::Mesh&,netgen::OPTIMIZEGOAL,netgen::NgBitArray const*)::{lambda(auto:1)#2},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.01161, value: 0.01161, min: 0.001021, max: 0.00134, avg: 0.001161}]} , { name: "Mesh::BuildBoundaryEdges", calls: 10, size: 0.2428, value: 0.2428, min: 6.544e-05, max: 0.03696, avg: 0.02428} , { name: "Mesh::Compress", calls: 10, size: 0.05446, value: 0.6925, min: 0.04296, max: 0.1385, avg: 0.06925, children: [{ name: "ngcore::ParallelForRange<netgen::ElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#1}>(ngcore::T_Range<netgen::ElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#1},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.209, value: 0.209, min: 0.01242, max: 0.07053, avg: 0.0209} , { name: "ngcore::ParallelForRange<netgen::SurfaceElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#2}>(ngcore::T_Range<netgen::SurfaceElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#2},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.08967, value: 0.08967, min: 0.003411, max: 0.03708, avg: 0.008967} , { name: "ngcore::ParallelForRange<netgen::ElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#3}>(ngcore::T_Range<netgen::ElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#3},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.03864, value: 0.03864, min: 0.001906, max: 0.01791, avg: 0.003864} , { name: "ngcore::ParallelForRange<netgen::SurfaceElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#4}>(ngcore::T_Range<netgen::SurfaceElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#4},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 10, size: 0.01976, value: 0.01976, min: 0.001636, max: 0.002814, avg: 0.001976} , { name: "Mesh::LinkSurfaceElements", calls: 10, size: 0.04705, value: 0.04705, min: 0.003702, max: 0.007636, avg: 0.004705} , { name: "Mesh::CalcSurfacesOfNode", calls: 10, size: 0.04551, value: 0.2339, min: 0.01458, max: 0.03425, avg: 0.02339, children: [{ name: "Mesh::CalcSurfacesOfNode, pointloop", calls: 10, size: 0.03738, value: 0.03738, min: 0.001604, max: 0.01692, avg: 0.003738} , { name: "Mesh::CalcSurfacesOfNode - surfelementht", calls: 10, size: 0.05019, value: 0.05019, min: 0.002794, max: 0.01559, avg: 0.005019} , { name: "Mesh::CalcSurfacesOfNode - surf on node", calls: 10, size: 0.1008, value: 0.1008, min: 0.007161, max: 0.01472, avg: 0.01008}]}]}]} , { name: "FreeOpenElementsEnvironment", calls: 2, size: 0.02064, value: 0.02064, min: 0.007102, max: 0.01354, avg: 0.01032} , { name: "Mesh::Compress", calls: 1, size: 0.006912, value: 0.04524, min: 0.04524, max: 0.04524, avg: 0.04524, children: [{ name: "ngcore::ParallelForRange<netgen::ElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#1}>(ngcore::T_Range<netgen::ElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#1},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 1, size: 0.01275, value: 0.01275, min: 0.01275, max: 0.01275, avg: 0.01275} , { name: "ngcore::ParallelForRange<netgen::SurfaceElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#2}>(ngcore::T_Range<netgen::SurfaceElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#2},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 1, size: 0.003736, value: 0.003736, min: 0.003736, max: 0.003736, avg: 0.003736} , { name: "ngcore::ParallelForRange<netgen::ElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#3}>(ngcore::T_Range<netgen::ElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#3},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 1, size: 0.00173, value: 0.00173, min: 0.00173, max: 0.00173, avg: 0.00173} , { name: "ngcore::ParallelForRange<netgen::SurfaceElementIndex,netgen::Mesh::Compress()::{lambda(auto:1)#4}>(ngcore::T_Range<netgen::SurfaceElementIndex>,netgen::Mesh::Compress()::{lambda(auto:1)#4},int,ngcore::TotalCosts)::{lambda(ngcore::TaskInfo&)#1}", calls: 1, size: 0.00172, value: 0.00172, min: 0.00172, max: 0.00172, avg: 0.00172} , { name: "Mesh::LinkSurfaceElements", calls: 1, size: 0.00393, value: 0.00393, min: 0.00393, max: 0.00393, avg: 0.00393} , { name: "Mesh::CalcSurfacesOfNode", calls: 1, size: 0.002867, value: 0.01446, min: 0.01446, max: 0.01446, avg: 0.01446, children: [{ name: "Mesh::CalcSurfacesOfNode, pointloop", calls: 1, size: 0.001596, value: 0.001596, min: 0.001596, max: 0.001596, avg: 0.001596} , { name: "Mesh::CalcSurfacesOfNode - surfelementht", calls: 1, size: 0.002693, value: 0.002693, min: 0.002693, max: 0.002693, avg: 0.002693} , { name: "Mesh::CalcSurfacesOfNode - surf on node", calls: 1, size: 0.007303, value: 0.007303, min: 0.007303, max: 0.007303, avg: 0.007303}]}]}]};

const chart_type = 'time';

    const color = d3.scaleOrdinal(d3.schemePaired);

    let getTime = (t) =>
    {
       if(t>=1000)  return (t/1000).toPrecision(4) + '  s';
       if(t>=0.1)   return t.toPrecision(4) + ' ms';
       if(t>=1e-4)  return (t*1e3).toPrecision(4) + ' us';

       return (t/1e6).toPrecision(4) + ' ns';
    };

    const KB_ = 1024;
    const MB_ = KB_*1024;
    const GB_ = MB_*1024;
    let getMemory = (m) =>
    {
       if(m>=GB_)  return (m/GB_).toPrecision(4) + ' GB';
       if(m>=MB_)  return (m/MB_).toPrecision(4) + ' MB';
       if(m>=KB_)  return (m/KB_).toPrecision(4) + ' KB';
       return m.toPrecision(4) + ' B';
    };

    Sunburst()
      .data(data)
      .size('size')
      .color(d => color(d.name))
      .tooltipTitle((d, node) => { return node.parent ? node.parent.data.name + " &rarr; " + d.name : d.name; })
      .tooltipContent((d, node) => {
        if(chart_type=="memory")
        {
          return `Total Memory: <i>${getMemory(d.value)}</i> <br>`
               + `Memory: <i>${getMemory(d.size)}</i>`
        }
        else
        {
          return `Time: <i>${getTime(d.value)}</i> <br>`
               + `calls: <i>${d.calls}</i> <br>`
               + `min: <i>${getTime(d.min)}</i> <br>`
               + `max: <i>${getTime(d.max)}</i> <br>`
               + `avg: <i>${getTime(d.avg)}</i>`
        }
      })
      (document.getElementById('chart'));

      // Line breaks in tooltip
      var all = document.getElementsByClassName('sunbirst-tooltip');
      for (var i = 0; i < all.length; i++) {
          all[i].white_space = "";
      }
  </script>
</body>

